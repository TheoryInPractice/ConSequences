// Copyright (c) 2015,2016 Microsoft Corporation

#if INTERACTIVE
#r @"..\bin\Liquid1.dll"         // Tell fsi where to find the Liquid dll
#else
namespace Microsoft.Research.Liquid // Tell the compiler our namespace
#endif

open System                         // Open any support libraries
open System.Collections.Generic

open Microsoft.Research.Liquid      // Get necessary Liquid libraries
open Util                           // General utilites
open Operations                     // Basic gates and operations

module Script =                     // The script module allows for incremental loading

    let dic = Dictionary<string,string>()   // Parameters to Fermion

    dic.["Test"]   <- "26"          // Test to process
    dic.["Bits"]   <- "18"          // Bit accuracy
    dic.["Trotter"]<- "32"          // Trotter number
    dic.["Thresh"] <- "-0.6"        // Max threshold to accept as an energy answer (with nuclear repulsion)
    dic.["Emin"]   <- "-2.5"        // Min possible energy (without nuclear repulsion)
    dic.["Emax"]   <- " 1.5"        // Max possible energy (without nuclear repulsion)
    dic.["Ecnt"]   <- "2"           // Electron count
    dic.["SOs"]    <- "4"           // Spin orbitals
    dic.["Preps"]  <- "[1;2]"       // "[1;2];[1;3];[1;4];[3;4]" // Prepared states to start in (list of lists)

    let data = [|
        "tst=0 info=0.50 nuc=2.000000 Ehf=-0.403326 0,0=-1.580012 1,1=0.107992 0,0,0,0=0.756697 0,0,1,1=0.159703 1,1,0,0=0.159703 0,1,0,1=0.159703 0,1,1,0=0.747124 1,1,1,1=0.791205"
        "tst=1 info=0.55 nuc=1.818182 Ehf=-0.551187 0,0=-1.561304 1,1=0.061561 0,0,0,0=0.753240 0,0,1,1=0.160526 1,1,0,0=0.160526 0,1,0,1=0.160526 0,1,1,0=0.743261 1,1,1,1=0.786563"
        "tst=2 info=0.60 nuc=1.666667 Ehf=-0.668256 0,0=-1.542241 1,1=0.015707 0,0,0,0=0.749560 0,0,1,1=0.161410 1,1,0,0=0.161410 0,1,0,1=0.161410 0,1,1,0=0.739175 1,1,1,1=0.781688"
        "tst=3 info=0.65 nuc=1.538462 Ehf=-0.761828 0,0=-1.522983 1,1=-0.029067 0,0,0,0=0.745677 0,0,1,1=0.162351 1,1,0,0=0.162351 0,1,0,1=0.162351 0,1,1,0=0.734897 1,1,1,1=0.776622"
        "tst=4 info=0.70 nuc=1.428571 Ehf=-0.837130 0,0=-1.503657 1,1=-0.072379 0,0,0,0=0.741613 0,0,1,1=0.163345 1,1,0,0=0.163345 0,1,0,1=0.163345 0,1,1,0=0.730456 1,1,1,1=0.771406"
        "tst=5 info=0.75 nuc=1.333333 Ehf=-0.897999 0,0=-1.484360 1,1=-0.113960 0,0,0,0=0.737387 0,0,1,1=0.164389 1,1,0,0=0.164389 0,1,0,1=0.164389 0,1,1,0=0.725880 1,1,1,1=0.766077"
        "tst=6 info=0.80 nuc=1.250000 Ehf=-0.947308 0,0=-1.465163 1,1=-0.153625 0,0,0,0=0.733018 0,0,1,1=0.165480 1,1,0,0=0.165480 0,1,0,1=0.165480 0,1,1,0=0.721196 1,1,1,1=0.760670"
        "tst=7 info=0.85 nuc=1.176471 Ehf=-0.987243 0,0=-1.446118 1,1=-0.191264 0,0,0,0=0.728523 0,0,1,1=0.166613 1,1,0,0=0.166613 0,1,0,1=0.166613 0,1,1,0=0.716430 1,1,1,1=0.755217"
        "tst=8 info=0.90 nuc=1.111111 Ehf=-1.019497 0,0=-1.427263 1,1=-0.226819 0,0,0,0=0.723918 0,0,1,1=0.167786 1,1,0,0=0.167786 0,1,0,1=0.167786 0,1,1,0=0.711604 1,1,1,1=0.749745"
        "tst=9 info=0.95 nuc=1.052632 Ehf=-1.045397 0,0=-1.408624 1,1=-0.260277 0,0,0,0=0.719219 0,0,1,1=0.168996 1,1,0,0=0.168996 0,1,0,1=0.168996 0,1,1,0=0.706739 1,1,1,1=0.744279"
        "tst=10 info=1.00 nuc=1.000000 Ehf=-1.065999 0,0=-1.390219 1,1=-0.291653 0,0,0,0=0.714439 0,0,1,1=0.170241 1,1,0,0=0.170241 0,1,0,1=0.170241 0,1,1,0=0.701853 1,1,1,1=0.738837"
        "tst=11 info=1.05 nuc=0.952381 Ehf=-1.082157 0,0=-1.372064 1,1=-0.320990 0,0,0,0=0.709590 0,0,1,1=0.171519 1,1,0,0=0.171519 0,1,0,1=0.171519 0,1,1,0=0.696963 1,1,1,1=0.733436"
        "tst=12 info=1.10 nuc=0.909091 Ehf=-1.094564 0,0=-1.354170 1,1=-0.348346 0,0,0,0=0.704685 0,0,1,1=0.172828 1,1,0,0=0.172828 0,1,0,1=0.172828 0,1,1,0=0.692084 1,1,1,1=0.728089"
        "tst=13 info=1.15 nuc=0.869565 Ehf=-1.103797 0,0=-1.336547 1,1=-0.373794 0,0,0,0=0.699732 0,0,1,1=0.174166 1,1,0,0=0.174166 0,1,0,1=0.174166 0,1,1,0=0.687226 1,1,1,1=0.722805"
        "tst=14 info=1.20 nuc=0.833333 Ehf=-1.110334 0,0=-1.319205 1,1=-0.397419 0,0,0,0=0.694743 0,0,1,1=0.175533 1,1,0,0=0.175533 0,1,0,1=0.175533 0,1,1,0=0.682400 1,1,1,1=0.717592"
        "tst=15 info=1.25 nuc=0.800000 Ehf=-1.114578 0,0=-1.302152 1,1=-0.419312 0,0,0,0=0.689727 0,0,1,1=0.176926 1,1,0,0=0.176926 0,1,0,1=0.176926 0,1,1,0=0.677615 1,1,1,1=0.712452"
        "tst=16 info=1.30 nuc=0.769231 Ehf=-1.116871 0,0=-1.285396 1,1=-0.439572 0,0,0,0=0.684691 0,0,1,1=0.178345 1,1,0,0=0.178345 0,1,0,1=0.178345 0,1,1,0=0.672877 1,1,1,1=0.707389"
        "tst=17 info=1.31 nuc=0.763359 Ehf=-1.117122 0,0=-1.282081 1,1=-0.443437 0,0,0,0=0.683682 0,0,1,1=0.178632 1,1,0,0=0.178632 0,1,0,1=0.178632 0,1,1,0=0.671935 1,1,1,1=0.706386"
        "tst=18 info=1.32 nuc=0.757576 Ehf=-1.117308 0,0=-1.278778 1,1=-0.447242 0,0,0,0=0.682673 0,0,1,1=0.178920 1,1,0,0=0.178920 0,1,0,1=0.178920 0,1,1,0=0.670996 1,1,1,1=0.705386"
        "tst=19 info=1.33 nuc=0.751880 Ehf=-1.117432 0,0=-1.275488 1,1=-0.450987 0,0,0,0=0.681664 0,0,1,1=0.179208 1,1,0,0=0.179208 0,1,0,1=0.179208 0,1,1,0=0.670059 1,1,1,1=0.704389"
        "tst=20 info=1.34 nuc=0.746269 Ehf=-1.117496 0,0=-1.272209 1,1=-0.454673 0,0,0,0=0.680654 0,0,1,1=0.179498 1,1,0,0=0.179498 0,1,0,1=0.179498 0,1,1,0=0.669124 1,1,1,1=0.703395"
        "tst=21 info=1.35 nuc=0.740741 Ehf=-1.117501 0,0=-1.268943 1,1=-0.458301 0,0,0,0=0.679644 0,0,1,1=0.179789 1,1,0,0=0.179789 0,1,0,1=0.179789 0,1,1,0=0.668192 1,1,1,1=0.702404"
        "tst=22 info=1.36 nuc=0.735294 Ehf=-1.117450 0,0=-1.265689 1,1=-0.461872 0,0,0,0=0.678634 0,0,1,1=0.180081 1,1,0,0=0.180081 0,1,0,1=0.180081 0,1,1,0=0.667261 1,1,1,1=0.701416"
        "tst=23 info=1.37 nuc=0.729927 Ehf=-1.117344 0,0=-1.262447 1,1=-0.465387 0,0,0,0=0.677624 0,0,1,1=0.180374 1,1,0,0=0.180374 0,1,0,1=0.180374 0,1,1,0=0.666334 1,1,1,1=0.700431"
        "tst=24 info=1.38 nuc=0.724638 Ehf=-1.117185 0,0=-1.259218 1,1=-0.468847 0,0,0,0=0.676614 0,0,1,1=0.180668 1,1,0,0=0.180668 0,1,0,1=0.180668 0,1,1,0=0.665408 1,1,1,1=0.699450"
        "tst=25 info=1.39 nuc=0.719424 Ehf=-1.116974 0,0=-1.256001 1,1=-0.472251 0,0,0,0=0.675604 0,0,1,1=0.180962 1,1,0,0=0.180962 0,1,0,1=0.180962 0,1,1,0=0.664485 1,1,1,1=0.698471"
        "tst=26 info=1.40 nuc=0.714286 Ehf=-1.116714 0,0=-1.252797 1,1=-0.475602 0,0,0,0=0.674594 0,0,1,1=0.181258 1,1,0,0=0.181258 0,1,0,1=0.181258 0,1,1,0=0.663564 1,1,1,1=0.697495"
        "tst=27 info=1.41 nuc=0.709220 Ehf=-1.116406 0,0=-1.249605 1,1=-0.478900 0,0,0,0=0.673584 0,0,1,1=0.181555 1,1,0,0=0.181555 0,1,0,1=0.181555 0,1,1,0=0.662646 1,1,1,1=0.696523"
        "tst=28 info=1.42 nuc=0.704225 Ehf=-1.116051 0,0=-1.246426 1,1=-0.482146 0,0,0,0=0.672575 0,0,1,1=0.181852 1,1,0,0=0.181852 0,1,0,1=0.181852 0,1,1,0=0.661730 1,1,1,1=0.695553"
        "tst=29 info=1.43 nuc=0.699301 Ehf=-1.115651 0,0=-1.243258 1,1=-0.485340 0,0,0,0=0.671566 0,0,1,1=0.182151 1,1,0,0=0.182151 0,1,0,1=0.182151 0,1,1,0=0.660816 1,1,1,1=0.694587"
        "tst=30 info=1.44 nuc=0.694444 Ehf=-1.115206 0,0=-1.240104 1,1=-0.488484 0,0,0,0=0.670557 0,0,1,1=0.182450 1,1,0,0=0.182450 0,1,0,1=0.182450 0,1,1,0=0.659905 1,1,1,1=0.693623"
        "tst=31 info=1.45 nuc=0.689655 Ehf=-1.114720 0,0=-1.236962 1,1=-0.491578 0,0,0,0=0.669548 0,0,1,1=0.182751 1,1,0,0=0.182751 0,1,0,1=0.182751 0,1,1,0=0.658997 1,1,1,1=0.692662"
        "tst=32 info=1.46 nuc=0.684932 Ehf=-1.114192 0,0=-1.233832 1,1=-0.494623 0,0,0,0=0.668540 0,0,1,1=0.183052 1,1,0,0=0.183052 0,1,0,1=0.183052 0,1,1,0=0.658091 1,1,1,1=0.691704"
        "tst=33 info=1.47 nuc=0.680272 Ehf=-1.113625 0,0=-1.230715 1,1=-0.497620 0,0,0,0=0.667533 0,0,1,1=0.183354 1,1,0,0=0.183354 0,1,0,1=0.183354 0,1,1,0=0.657188 1,1,1,1=0.690750"
        "tst=34 info=1.50 nuc=0.666667 Ehf=-1.111696 0,0=-1.221438 1,1=-0.506330 0,0,0,0=0.664514 0,0,1,1=0.184266 1,1,0,0=0.184266 0,1,0,1=0.184266 0,1,1,0=0.654493 1,1,1,1=0.687903"
        "tst=35 info=1.60 nuc=0.625000 Ehf=-1.103141 0,0=-1.191324 1,1=-0.532544 0,0,0,0=0.654507 0,0,1,1=0.187365 1,1,0,0=0.187365 0,1,0,1=0.187365 0,1,1,0=0.645683 1,1,1,1=0.678594"
        "tst=36 info=1.70 nuc=0.588235 Ehf=-1.092006 0,0=-1.162434 1,1=-0.554956 0,0,0,0=0.644626 0,0,1,1=0.190547 1,1,0,0=0.190547 0,1,0,1=0.190547 0,1,1,0=0.637144 1,1,1,1=0.669552"
        "tst=37 info=1.80 nuc=0.555556 Ehf=-1.078982 0,0=-1.134730 1,1=-0.574177 0,0,0,0=0.634922 0,0,1,1=0.193807 1,1,0,0=0.193807 0,1,0,1=0.193807 0,1,1,0=0.628882 1,1,1,1=0.660759"
        "tst=38 info=1.90 nuc=0.526316 Ehf=-1.064577 0,0=-1.108166 1,1=-0.590708 0,0,0,0=0.625440 0,0,1,1=0.197135 1,1,0,0=0.197135 0,1,0,1=0.197135 0,1,1,0=0.620900 1,1,1,1=0.652202"
        "tst=39 info=2.00 nuc=0.500000 Ehf=-1.049171 0,0=-1.082695 1,1=-0.604948 0,0,0,0=0.616220 0,0,1,1=0.200522 1,1,0,0=0.200522 0,1,0,1=0.200522 0,1,1,0=0.613198 1,1,1,1=0.643875"
        "tst=40 info=2.20 nuc=0.454545 Ehf=-1.016486 0,0=-1.034867 1,1=-0.627755 0,0,0,0=0.598702 0,0,1,1=0.207428 1,1,0,0=0.207428 0,1,0,1=0.207428 0,1,1,0=0.598639 1,1,1,1=0.627898"
        "tst=41 info=2.40 nuc=0.416667 Ehf=-0.982699 0,0=-0.990970 1,1=-0.644442 0,0,0,0=0.582575 0,0,1,1=0.214430 1,1,0,0=0.214430 0,1,0,1=0.214430 0,1,1,0=0.585195 1,1,1,1=0.612839"
        "tst=42 info=2.60 nuc=0.384615 Ehf=-0.949043 0,0=-0.950801 1,1=-0.656289 0,0,0,0=0.567943 0,0,1,1=0.221434 1,1,0,0=0.221434 0,1,0,1=0.221434 0,1,1,0=0.572841 1,1,1,1=0.598730"
        "tst=43 info=2.80 nuc=0.357143 Ehf=-0.916377 0,0=-0.914171 1,1=-0.664283 0,0,0,0=0.554823 0,0,1,1=0.228353 1,1,0,0=0.228353 0,1,0,1=0.228353 0,1,1,0=0.561537 1,1,1,1=0.585593"
        "tst=44 info=3.00 nuc=0.333333 Ehf=-0.885275 0,0=-0.880883 1,1=-0.669233 0,0,0,0=0.543158 0,0,1,1=0.235117 1,1,0,0=0.235117 0,1,0,1=0.235117 0,1,1,0=0.551226 1,1,1,1=0.573432"
        "tst=45 info=3.20 nuc=0.312500 Ehf=-0.856097 0,0=-0.850723 1,1=-0.671802 0,0,0,0=0.532850 0,0,1,1=0.241670 1,1,0,0=0.241670 0,1,0,1=0.241670 0,1,1,0=0.541842 1,1,1,1=0.562224"
        "tst=46 info=3.40 nuc=0.294118 Ehf=-0.829044 0,0=-0.823467 1,1=-0.672524 0,0,0,0=0.523773 0,0,1,1=0.247971 1,1,0,0=0.247971 0,1,0,1=0.247971 0,1,1,0=0.533312 1,1,1,1=0.551925"
        "tst=47 info=3.60 nuc=0.277778 Ehf=-0.804201 0,0=-0.798886 1,1=-0.671825 0,0,0,0=0.515795 0,0,1,1=0.253990 1,1,0,0=0.253990 0,1,0,1=0.253990 0,1,1,0=0.525558 1,1,1,1=0.542475"
        "tst=48 info=3.80 nuc=0.263158 Ehf=-0.781568 0,0=-0.776755 1,1=-0.670042 0,0,0,0=0.508783 0,0,1,1=0.259712 1,1,0,0=0.259712 0,1,0,1=0.259712 0,1,1,0=0.518507 1,1,1,1=0.533808"
        "tst=49 info=4.00 nuc=0.250000 Ehf=-0.761082 0,0=-0.756849 1,1=-0.667440 0,0,0,0=0.502616 0,0,1,1=0.265128 1,1,0,0=0.265128 0,1,0,1=0.265128 0,1,1,0=0.512086 1,1,1,1=0.525855"
        "tst=50 info=4.50 nuc=0.222222 Ehf=-0.718495 0,0=-0.715447 1,1=-0.658640 0,0,0,0=0.490176 0,0,1,1=0.277332 1,1,0,0=0.277332 0,1,0,1=0.277332 0,1,1,0=0.498365 1,1,1,1=0.508681"
        "tst=51 info=5.00 nuc=0.200000 Ehf=-0.686416 0,0=-0.683631 1,1=-0.648202 0,0,0,0=0.480847 0,0,1,1=0.287733 1,1,0,0=0.287733 0,1,0,1=0.287733 0,1,1,0=0.487294 1,1,1,1=0.494710"
        "tst=52 info=5.50 nuc=0.181818 Ehf=-0.662593 0,0=-0.658969 1,1=-0.637355 0,0,0,0=0.473526 0,0,1,1=0.296545 1,1,0,0=0.296545 0,1,0,1=0.296545 0,1,1,0=0.478211 1,1,1,1=0.483300"
        "tst=53 info=6.00 nuc=0.166667 Ehf=-0.645077 0,0=-0.639604 1,1=-0.626732 0,0,0,0=0.467465 0,0,1,1=0.304020 1,1,0,0=0.304020 0,1,0,1=0.304020 0,1,1,0=0.470636 1,1,1,1=0.473962"
        "tst=54 info=6.50 nuc=0.153846 Ehf=-0.632237 0,0=-0.624147 1,1=-0.616658 0,0,0,0=0.462210 0,0,1,1=0.310395 1,1,0,0=0.310395 0,1,0,1=0.310395 0,1,1,0=0.464226 1,1,1,1=0.466297"
        "tst=55 info=7.00 nuc=0.142857 Ehf=-0.622750 0,0=-0.611564 1,1=-0.607298 0,0,0,0=0.457521 0,0,1,1=0.315879 1,1,0,0=0.315879 0,1,0,1=0.315879 0,1,1,0=0.458731 1,1,1,1=0.459960"
        "tst=56 info=7.50 nuc=0.133333 Ehf=-0.615596 0,0=-0.601105 1,1=-0.598721 0,0,0,0=0.453280 0,0,1,1=0.320638 1,1,0,0=0.320638 0,1,0,1=0.320638 0,1,1,0=0.453970 1,1,1,1=0.454665"
        "tst=57 info=8.00 nuc=0.125000 Ehf=-0.610039 0,0=-0.592234 1,1=-0.590929 0,0,0,0=0.449429 0,0,1,1=0.324803 1,1,0,0=0.324803 0,1,0,1=0.324803 0,1,1,0=0.449803 1,1,1,1=0.450179"
        "tst=58 info=8.50 nuc=0.117647 Ehf=-0.605576 0,0=-0.584578 1,1=-0.583879 0,0,0,0=0.445933 0,0,1,1=0.328480 1,1,0,0=0.328480 0,1,0,1=0.328480 0,1,1,0=0.446126 1,1,1,1=0.446321"
        "tst=59 info=9.00 nuc=0.111111 Ehf=-0.601876 0,0=-0.577875 1,1=-0.577511 0,0,0,0=0.442763 0,0,1,1=0.331747 1,1,0,0=0.331747 0,1,0,1=0.331747 0,1,1,0=0.442859 1,1,1,1=0.442954"
        "tst=60 info=9.50 nuc=0.105263 Ehf=-0.598721 0,0=-0.571937 1,1=-0.571753 0,0,0,0=0.439889 0,0,1,1=0.334671 1,1,0,0=0.334671 0,1,0,1=0.334671 0,1,1,0=0.439935 1,1,1,1=0.439980"
        "tst=61 info=10.00 nuc=0.100000 Ehf=-0.595971 0,0=-0.566627 1,1=-0.566537 0,0,0,0=0.437283 0,0,1,1=0.337303 1,1,0,0=0.337303 0,1,0,1=0.337303 0,1,1,0=0.437303 1,1,1,1=0.437323"
        "tst=62 info=10.00 nuc=0.100000 Ehf=-0.595971 0,0=-0.566627 1,1=-0.566537 0,0,0,0=0.437283 0,0,1,1=0.337303 1,1,0,0=0.337303 0,1,0,1=0.337303 0,1,1,0=0.437303 1,1,1,1=0.437323"
        "tst=63 info=20.00 nuc=0.050000 Ehf=-0.570861 0,0=-0.516582 1,1=-0.516582 0,0,0,0=0.412303 0,0,1,1=0.362303 1,1,0,0=0.362303 0,1,0,1=0.362303 0,1,1,0=0.412303 1,1,1,1=0.412303"
        "tst=64 info=30.00 nuc=0.033333 Ehf=-0.191891 0,0=-0.499915 1,1=-0.499915 0,0,0,0=0.774606 0,1,1,0=0.033333 1,1,1,1=0.774606"
        "tst=65 info=40.00 nuc=0.025000 Ehf=-0.183558 0,0=-0.491582 1,1=-0.491582 0,0,0,0=0.774606 0,1,1,0=0.025000 1,1,1,1=0.774606"
        "tst=66 info=50.00 nuc=0.020000 Ehf=-0.178558 0,0=-0.486582 1,1=-0.486582 0,0,0,0=0.774606 0,1,1,0=0.020000 1,1,1,1=0.774606"
        "tst=67 info=60.00 nuc=0.016667 Ehf=-0.175224 0,0=-0.483249 1,1=-0.483249 0,0,0,0=0.774606 0,1,1,0=0.016667 1,1,1,1=0.774606"
        "tst=68 info=70.00 nuc=0.014286 Ehf=-0.172843 0,0=-0.480868 1,1=-0.480868 0,0,0,0=0.774606 0,1,1,0=0.014286 1,1,1,1=0.774606"
        "tst=69 info=80.00 nuc=0.012500 Ehf=-0.171058 0,0=-0.479082 1,1=-0.479082 0,0,0,0=0.774606 0,1,1,0=0.012500 1,1,1,1=0.774606"
        "tst=70 info=90.00 nuc=0.011111 Ehf=-0.169669 0,0=-0.477693 1,1=-0.477693 0,0,0,0=0.774606 0,1,1,0=0.011111 1,1,1,1=0.774606"
        "tst=71 info=100.00 nuc=0.010000 Ehf=-0.168558 0,0=-0.476582 1,1=-0.476582 0,0,0,0=0.774606 0,1,1,0=0.010000 1,1,1,1=0.774606"
    |]

    [<LQD>]
    let Test(tst:int) =
        dic.["Test"]       <- string tst
        Fermion.Run(dic,data)

    [<LQD>]
    let Trot(trotterN:int) =
        dic.["Trotter"]    <- string trotterN
        Fermion.Run(dic,data)
    
#if INTERACTIVE
do Script.Test(26)        // If interactive, then run the routine automatically
#endif
